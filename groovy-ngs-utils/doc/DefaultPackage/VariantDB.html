<!--

     Licensed to the Apache Software Foundation (ASF) under one
     or more contributor license agreements.  See the NOTICE file
     distributed with this work for additional information
     regarding copyright ownership.  The ASF licenses this file
     to you under the Apache License, Version 2.0 (the
     "License"); you may not use this file except in compliance
     with the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing,
     software distributed under the License is distributed on an
     "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
     specific language governing permissions and limitations
     under the License.

-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- **************************************************************** -->
<!-- *  PLEASE KEEP COMPLICATED EXPRESSIONS OUT OF THESE TEMPLATES, * -->
<!-- *  i.e. only iterate & print data where possible. Thanks, Jez. * -->
<!-- **************************************************************** -->

<html>
<head>
    <!-- Generated by groovydoc (2.4.10) on Wed Mar 21 11:32:22 AEDT 2018 -->
    <title>VariantDB (groovy-ngs-utils API)</title>
    <meta name="date" content="2018-03-21">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="../groovy.ico" type="image/x-icon" rel="shortcut icon">
    <link href="../groovy.ico" type="image/x-icon" rel="icon">
    <link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">

<body class="center">
<script type="text/javascript"><!--
if (location.href.indexOf('is-external=true') == -1) {
    parent.document.title="VariantDB (groovy-ngs-utils API)";
}
//-->
</script>
<noscript>
    <div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
    <!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
    <!--   -->
</a>
    <ul class="navList" title="Navigation">
        <li><a href="../overview-summary.html">Overview</a></li>
        <li><a href="package-summary.html">Package</a></li>
        <li class="navBarCell1Rev">Class</li>
        <li><a href="../deprecated-list.html">Deprecated</a></li>
        <li><a href="../index-all.html">Index</a></li>
        <li><a href="../help-doc.html">Help</a></li>
    </ul>
</div>

<div class="subNav">
    <div>
        <ul class="navList">
            <li><a href="../index.html?DefaultPackage/VariantDB" target="_top">Frames</a></li>
            <li><a href="VariantDB.html" target="_top">No Frames</a></li>
        </ul>
    </div>
    <div>
        <ul class="subNavList">
            <li>Summary:&nbsp;</li>
            Nested&nbsp;&nbsp;&nbsp;Field&nbsp;&nbsp;&nbsp;<li><a href="#property_summary">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_summary">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_summary">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
        <ul class="subNavList">
            <li>&nbsp;|&nbsp;Detail:&nbsp;</li>
            Field&nbsp;&nbsp;&nbsp;<li><a href="#prop_detail">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_detail">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_detail">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
    </div>
    <a name="skip-navbar_top">
        <!--   -->
    </a></div>
<!-- ========= END OF TOP NAVBAR ========= -->

<!-- ======== START OF CLASS DATA ======== -->
<div class="header">

    <h2 title="[Groovy] Class VariantDB" class="title">[Groovy] Class VariantDB</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><ul class="inheritance"></ul></li><li>VariantDB
</ul>
<div class="description">
    <ul class="blockList">
        <li class="blockList">

            <dl>
                <dt>All Implemented Interfaces and Traits:</dt>
                <dd><a href='../Closeable.html'>Closeable</a></dd>
            </dl>
            <!-- todo: direct known subclasses -->
            <hr>
            <br>
<pre>@groovy.util.logging.Log
class VariantDB
extends java.lang.Object

</pre>



    <p> VariantDB implements a simple, embedded, variant tracking database that
 can be used to track variants identified in multiple samples and 
 sequencing runs. It allows quick computation of variant counts
 across samples, families, batches of samples, etc.
 <p>
 For the full power of the database, you shoudl use a PED file, parsed
 with the Pedigrees class when adding variants and samples. However this
 parameter can be passed as null, in which case all samples are treated
 as singletons. You should be aware that variant counts will not be family
 aware in such cases and thus will be distorted if your sequencing has
 large pedigrees and compared to the overall sample count.
 <p>
 To add variants, parse them using the VCF class and then simple use the 
 #add method:
 <pre>
 VariantDB db = new VariantDB("test.db")
 VCF.parse("test.vcf") { v ->
     db.add("batch1", null, v)
 }
 </pre>
 <DL><DT><B>Authors:</B></DT><DD>simon</DD></DL></p>

          </li>
    </ul>
</div>

<div class="summary">
    <ul class="blockList">
        <li class="blockList">
        <!-- =========== NESTED CLASS SUMMARY =========== -->
        

        <!-- =========== ENUM CONSTANT SUMMARY =========== -->
        
        <!-- =========== FIELD SUMMARY =========== -->
        

        <!-- =========== PROPERTY SUMMARY =========== -->
        
         <ul class="blockList">
                <li class="blockList"><a name="property_summary"><!--   --></a>
                    <h3>Properties Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties Summary table, listing nested classes, and an explanation">
                        <caption><span>Properties</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Type</th>
                            <th class="colLast" scope="col">Name and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code><strong>static&nbsp;java.lang.Object</strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#ANNOVAR_ANNOTATION_PROFILE">ANNOVAR_ANNOTATION_PROFILE</a></code><br></td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code><strong>Map&lt;String, List&lt;String&gt;&gt;</strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#annotationProfile">annotationProfile</a></code><br></td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code><strong>Map&lt;String, Object&gt;</strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#cachedSampleInfo">cachedSampleInfo</a></code><br>Map of string to database rows of cached sample information</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code><strong>java.lang.String</strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#connectString">connectString</a></code><br>The file name of the database that is connected to</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code><strong>groovy.sql.Sql</strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#db">db</a></code><br>The actual database connection</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code><strong>java.lang.String</strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#driver">driver</a></code><br>The file name of the database that is connected to</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code><strong><a href='../db/Schema.html'>Schema</a></strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#schema">schema</a></code><br>Schema for database</td>
                        </tr>
                        
                    </table>
                   </ul>
                </li>
            </ul>
        

        <!-- =========== ELEMENT SUMMARY =========== -->
        

        
        <!-- ======== CONSTRUCTOR SUMMARY ======== -->
        <ul class="blockList">
                <li class="blockList"><a name="constructor_summary"><!--   --></a>
                    <h3>Constructor Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructors Summary table">
                        <caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Constructor and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst">
                                <code><a href="#VariantDB(java.lang.String)">VariantDB</a>
                                (java.lang.String fileName)</code><br>Open or create a VariantDB using default settings and the given
 file name. </td>
                        </tr>
                        
                    </table>
                   </ul>
              </li>
        </ul>
        

        
        <!-- ========== METHOD SUMMARY =========== -->
        <ul class="blockList">
            
            <li class="blockList"><a name="method_summary"><!--   --></a>
                    <h3>Methods Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Methods Summary table">
                        <caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Type Params</th>
                            <th class="colLast" scope="col">Return Type</th>
                            <th class="colLast" scope="col">Name and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>int</code></td>
                            <td class="colLast"><code><strong><a href="#add(java.lang.String, gngs.Pedigrees, gngs.Variant, gngs.Allele, java.lang.String, java.lang.String, def)">add</a></strong>(java.lang.String batch, <a href='../gngs/Pedigrees.html'>Pedigrees</a> peds, <a href='../gngs/Variant.html'>Variant</a> v, <a href='../gngs/Allele.html'>Allele</a> alleleToAdd = null, java.lang.String cohort = null, java.lang.String sampleToAdd = null, java.lang.Object annotations = null)</code><br>Add the given variant to the database. </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='../Map.html'>Map</a></code></td>
                            <td class="colLast"><code><strong><a href="#addCachedSampleInfo(List<String>, java.lang.String, java.lang.String, gngs.Pedigrees)">addCachedSampleInfo</a></strong>(List&lt;String&gt; addSamples, java.lang.String batch, java.lang.String cohort, <a href='../gngs/Pedigrees.html'>Pedigrees</a> peds = null)</code><br>Returns cached rows from the sample table for each sample. </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>java.lang.Object</code></td>
                            <td class="colLast"><code><strong><a href="#addSample(java.lang.String, gngs.Pedigrees, java.lang.String, java.lang.String)">addSample</a></strong>(java.lang.String sampleId, <a href='../gngs/Pedigrees.html'>Pedigrees</a> peds = null, java.lang.String cohort = null, java.lang.String batch = null)</code><br>Add information about the given sample to the database</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#addSampleBatch(java.lang.Long, java.lang.String, java.lang.String)">addSampleBatch</a></strong>(java.lang.Long sampleId, java.lang.String batch, java.lang.String cohort)</code><br></td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#close()">close</a></strong>()</code><br></td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='../Map.html'>Map</a></code></td>
                            <td class="colLast"><code><strong><a href="#countObservations(java.lang.String, int, int, java.lang.String)">countObservations</a></strong>(java.lang.String chr, int start, int end, java.lang.String alt)</code><br>Returns a map containing the following keys:
   <li>sampleCount - the number of unique samples in which the variant was observed
   <li>familyCount - the number of unique families in which the variant was observed</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='../Map.html'>Map</a></code></td>
                            <td class="colLast"><code><strong><a href="#countObservations(gngs.Variant, gngs.Allele, java.lang.String)">countObservations</a></strong>(<a href='../gngs/Variant.html'>Variant</a> v, <a href='../gngs/Allele.html'>Allele</a> allele, java.lang.String batch = null)</code><br>Return a counts of the number of observations of the given variant.
 </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>java.lang.Object</code></td>
                            <td class="colLast"><code><strong><a href="#findSample(java.lang.String)">findSample</a></strong>(java.lang.String sampleId)</code><br>Return row of database representing sample, or null if it does not
 exist.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>java.lang.Object</code></td>
                            <td class="colLast"><code><strong><a href="#findVariant(gngs.Variant, gngs.Allele)">findVariant</a></strong>(<a href='../gngs/Variant.html'>Variant</a> variant, <a href='../gngs/Allele.html'>Allele</a> allele)</code><br>Find a variant in the database by its start position</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>java.lang.Object</code></td>
                            <td class="colLast"><code><strong><a href="#getAnnotation(java.lang.String, def)">getAnnotation</a></strong>(java.lang.String type, java.lang.Object annotations)</code><br>Search for the given value in the annotations as a frequency
 value.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>java.lang.Float</code></td>
                            <td class="colLast"><code><strong><a href="#getFreq(java.lang.String, def)">getFreq</a></strong>(java.lang.String type, java.lang.Object annotations)</code><br>Search for the given value in the annotations as a frequency
 value.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#init()">init</a></strong>()</code><br>Check the database exists and upgrade it if necessary</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;void</code></td>
                            <td class="colLast"><code><strong><a href="#main(java.lang.String)">main</a></strong>(java.lang.String[] args)</code><br>Simple test program - all it does is creates the database</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='../Map.html'>Map</a></code></td>
                            <td class="colLast"><code><strong><a href="#queryVariantCounts(Map, gngs.Variant, gngs.Allele, java.lang.String)">queryVariantCounts</a></strong>(<a href='../Map.html'>Map</a> options = [:], <a href='../gngs/Variant.html'>Variant</a> variant, <a href='../gngs/Allele.html'>Allele</a> allele, java.lang.String sampleId)</code><br>Return a set of counts of times the given variant has been 
 observed with in</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>java.lang.String</code></td>
                            <td class="colLast"><code><strong><a href="#trimSampleId(java.lang.String)">trimSampleId</a></strong>(java.lang.String sampleId)</code><br></td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#tx(Closure)">tx</a></strong>(<a href='../Closure.html'>Closure</a> c)</code><br>Execute the given closure in teh scope of a transaction, and roll it back if
 an exception occurs.</td>
                        </tr>
                        
                    </table>
                   </ul>
              </li>
            
            <li class="blockList"><a name="method_summary"><!--   --></a>
                    <h3>Inherited Methods Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Inherited Methods Summary table">
                        <caption><span>Inherited Methods</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Methods inherited from class</th>
                            <th class="colLast" scope="col">Name</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code>class java.lang.Object</code></td>
                            <td class="colLast"><code>java.lang.Object#wait(long, int), java.lang.Object#wait(long), java.lang.Object#wait(), java.lang.Object#equals(java.lang.Object), java.lang.Object#toString(), java.lang.Object#hashCode(), java.lang.Object#getClass(), java.lang.Object#notify(), java.lang.Object#notifyAll()</code></td>
                        </tr>
                    </table>
                   </ul>
              </li>
                
        </ul>
        
    </li>
    </ul>
</div>

<div class="details">
    <ul class="blockList">
        <li class="blockList">
           

            

            
            <!-- =========== PROPERTY DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="prop_detail">
                    <!--   -->
                </a>
                    <h3>Property Detail</h3>
                    
                        <a name="ANNOVAR_ANNOTATION_PROFILE"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;final&nbsp;java.lang.Object <strong>ANNOVAR_ANNOTATION_PROFILE</strong></h4>
                                <p></p>
                            </li>
                        </ul>
                    
                        <a name="annotationProfile"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>Map&lt;String, List&lt;String&gt;&gt; <strong>annotationProfile</strong></h4>
                                <p></p>
                            </li>
                        </ul>
                    
                        <a name="cachedSampleInfo"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>Map&lt;String, Object&gt; <strong>cachedSampleInfo</strong></h4>
                                <p> Map of string to database rows of cached sample information
     </p>
                            </li>
                        </ul>
                    
                        <a name="connectString"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.String <strong>connectString</strong></h4>
                                <p> The file name of the database that is connected to
     </p>
                            </li>
                        </ul>
                    
                        <a name="db"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>groovy.sql.Sql <strong>db</strong></h4>
                                <p> The actual database connection
     </p>
                            </li>
                        </ul>
                    
                        <a name="driver"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.String <strong>driver</strong></h4>
                                <p> The file name of the database that is connected to
     </p>
                            </li>
                        </ul>
                    
                        <a name="schema"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='../db/Schema.html'>Schema</a> <strong>schema</strong></h4>
                                <p> Schema for database
     </p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            

            

            
            <!-- =========== CONSTRUCTOR DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="constructor_detail">
                    <!--   -->
                </a>
                    <h3>Constructor Detail</h3>
                    
                        <a name="VariantDB(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>VariantDB</strong>(java.lang.String fileName)</h4>
                                <p> Open or create a VariantDB using default settings and the given
 file name. These connect to a SQLite database with the given name.
     <DL><DT><B>Parameters:</B></DT><DD>fileName</DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            


            
            <!-- =========== METHOD DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="method_detail">
                    <!--   -->
                </a>
                    <h3>Method Detail</h3>
                    
                        <a name="add(java.lang.String, gngs.Pedigrees, gngs.Variant, gngs.Allele, java.lang.String, java.lang.String, def)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>int <strong>add</strong>(java.lang.String batch, <a href='../gngs/Pedigrees.html'>Pedigrees</a> peds, <a href='../gngs/Variant.html'>Variant</a> v, <a href='../gngs/Allele.html'>Allele</a> alleleToAdd = null, java.lang.String cohort = null, java.lang.String sampleToAdd = null, java.lang.Object annotations = null)</h4>
                                <p> Add the given variant to the database. If sampleToAdd is specified,
 add it for only the given sample. Otherwise add it for all the samples that 
 are genotyped to have the variant
     <DL><DT><B>Returns:</B></DT><DD>count of variants added</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>annotations</code> -    optional annotations to draw from. These can be used when 
                      the annotations are not embedded in the VCF file. The annotations
                      are queried for keys defined in the annotationProfile field.
                      The default mappings are set up to look for Annovar annotations.
                      The annotations themselves can be any object having properties which 
                      will be queried. In practise, a CSV parser PropertyMapper is
                      what is being used here to pass in Annovar annotations.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="addCachedSampleInfo(List<String>, java.lang.String, java.lang.String, gngs.Pedigrees)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='../Map.html'>Map</a> <strong>addCachedSampleInfo</strong>(List&lt;String&gt; addSamples, java.lang.String batch, java.lang.String cohort, <a href='../gngs/Pedigrees.html'>Pedigrees</a> peds = null)</h4>
                                <p> Returns cached rows from the sample table for each sample. If rows do not exist yet for
 the sample, adds rows to the table. If rows do exist, returns the existing rows.
 Also adds batch information.
     <DL><DT><B>Returns:</B></DT><DD>a map keyed on sample id, with values being the row from the sample 
         table for each sample</DD></DL><DL><DT><B>Parameters:</B></DT><DD>addSamples</DD><DD>batch</DD><DD>cohort</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="addSample(java.lang.String, gngs.Pedigrees, java.lang.String, java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.Object <strong>addSample</strong>(java.lang.String sampleId, <a href='../gngs/Pedigrees.html'>Pedigrees</a> peds = null, java.lang.String cohort = null, java.lang.String batch = null)</h4>
                                <p> Add information about the given sample to the database <DL><DT><B>Returns:</B></DT><DD></DD></DL><DL><DT><B>Parameters:</B></DT><DD>sampleId</DD><DD>peds</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="addSampleBatch(java.lang.Long, java.lang.String, java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>addSampleBatch</strong>(java.lang.Long sampleId, java.lang.String batch, java.lang.String cohort)</h4>
                                <p></p>
                            </li>
                        </ul>
                    
                        <a name="close()"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>close</strong>()</h4>
                                <p></p>
                            </li>
                        </ul>
                    
                        <a name="countObservations(java.lang.String, int, int, java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='../Map.html'>Map</a> <strong>countObservations</strong>(java.lang.String chr, int start, int end, java.lang.String alt)</h4>
                                <p> Returns a map containing the following keys:
   <li>sampleCount - the number of unique samples in which the variant was observed
   <li>familyCount - the number of unique families in which the variant was observed
     <DL><DT><B>Returns:</B></DT><DD>Map with keys indicating counts of observations of this variant</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>chr</code> -    Chromosome of variant</DD><DD><code>start</code> -  starting position of DNA change caused by variant (note this may be different 
        to VCF position depending on the representation of your indel in the VCF!)</DD><DD><code>end</code> -    end position of DNA change caused by variant</DD><DD><code>alt</code> -    alternate sequence</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="countObservations(gngs.Variant, gngs.Allele, java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='../Map.html'>Map</a> <strong>countObservations</strong>(<a href='../gngs/Variant.html'>Variant</a> v, <a href='../gngs/Allele.html'>Allele</a> allele, java.lang.String batch = null)</h4>
                                <p> Return a counts of the number of observations of the given variant.
 Two values are returned: 
   <li>sampleCount - the number of unique samples in which the variant was observed
   <li>familyCount - the number of unique families in which the variant was observed
     <DL><DT><B>Parameters:</B></DT><DD><code>batch</code> -  If provided, variants will only be provided if they are observed in
              this batch OR any earlier batch. The intent is to support reproducibility
              so that new samples can be added to the database without changing the
              variant counts if queried for old samples.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="findSample(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.Object <strong>findSample</strong>(java.lang.String sampleId)</h4>
                                <p> Return row of database representing sample, or null if it does not
 exist.
     </p>
                            </li>
                        </ul>
                    
                        <a name="findVariant(gngs.Variant, gngs.Allele)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.Object <strong>findVariant</strong>(<a href='../gngs/Variant.html'>Variant</a> variant, <a href='../gngs/Allele.html'>Allele</a> allele)</h4>
                                <p> Find a variant in the database by its start position
     </p>
                            </li>
                        </ul>
                    
                        <a name="getAnnotation(java.lang.String, def)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.Object <strong>getAnnotation</strong>(java.lang.String type, java.lang.Object annotations)</h4>
                                <p> Search for the given value in the annotations as a frequency
 value.
     <DL><DT><B>Returns:</B></DT><DD>the value of the annotation or null if it is not available</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>type</code> -           The type of value to search for, must be one of the 
                      predefined annotation profile keys</DD><DD><code>annotations</code> -    The annotations to search</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="getFreq(java.lang.String, def)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.Float <strong>getFreq</strong>(java.lang.String type, java.lang.Object annotations)</h4>
                                <p> Search for the given value in the annotations as a frequency
 value. <DL><DT><B>Returns:</B></DT><DD></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>type</code> -           The type of frequency to search for, must be a key in the annotation profile</DD><DD><code>annotations</code> -    The annotations to search</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="init()"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>init</strong>()</h4>
                                <p> Check the database exists and upgrade it if necessary
     </p>
                            </li>
                        </ul>
                    
                        <a name="main(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;void <strong>main</strong>(java.lang.String[] args)</h4>
                                <p> Simple test program - all it does is creates the database
     <DL><DT><B>Parameters:</B></DT><DD>args</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="queryVariantCounts(Map, gngs.Variant, gngs.Allele, java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='../Map.html'>Map</a> <strong>queryVariantCounts</strong>(<a href='../Map.html'>Map</a> options = [:], <a href='../gngs/Variant.html'>Variant</a> variant, <a href='../gngs/Allele.html'>Allele</a> allele, java.lang.String sampleId)</h4>
                                <p> Return a set of counts of times the given variant has been 
 observed with in
 
 <li> all cohorts
 <li> all except the specified cohort
 <li> within the specified cohort
 
 Additional cohorts can be excluded by setting a comma separated list as the
 value 'excludeCohorts' in options.
 <p>
 The returned map has 3 attributes:
 <li>total - total number of smaples observed to have the variant, regardless of cohort
 <li>in_target - total number of samples observed to have the variant within specified cohort
 <li>other_target - total number of samples observed to have the variant outside of specified cohort
     </p>
                            </li>
                        </ul>
                    
                        <a name="trimSampleId(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>java.lang.String <strong>trimSampleId</strong>(java.lang.String sampleId)</h4>
                                <p></p>
                            </li>
                        </ul>
                    
                        <a name="tx(Closure)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>tx</strong>(<a href='../Closure.html'>Closure</a> c)</h4>
                                <p> Execute the given closure in teh scope of a transaction, and roll it back if
 an exception occurs.
     <DL><DT><B>Parameters:</B></DT><DD><code>c</code> -      Closure to execute</DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            
        </li>
    </ul>
</div>

<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
    <!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
    <!--   -->
</a>
    <ul class="navList" title="Navigation">
        <li><a href="../overview-summary.html">Overview</a></li>
        <li><a href="package-summary.html">Package</a></li>
        <li class="navBarCell1Rev">Class</li>
        <li><a href="../deprecated-list.html">Deprecated</a></li>
        <li><a href="../index-all.html">Index</a></li>
        <li><a href="../help-doc.html">Help</a></li>
    </ul>
</div>

<div class="subNav">
    <div>
        <ul class="navList">
            <li><a href="../index.html?DefaultPackage/VariantDB" target="_top">Frames</a></li>
            <li><a href="VariantDB.html" target="_top">No Frames</a></li>
        </ul>
    </div>
    <div>
        <ul class="subNavList">
            <li>Summary:&nbsp;</li>
            Nested&nbsp;&nbsp;&nbsp;Field&nbsp;&nbsp;&nbsp;<li><a href="#property_summary">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_summary">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_summary">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
        <ul class="subNavList">
            <li>&nbsp;|&nbsp;Detail:&nbsp;</li>
            Field&nbsp;&nbsp;&nbsp;<li><a href="#prop_detail">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_detail">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_detail">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
    </div>
    <p>Groovy Documentation</p>
    <a name="skip-navbar_bottom">
        <!--   -->
    </a>
    </div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
